import{_ as e}from"./breadcrumbs-DZYgaiqi.js";import{r as a,b as t,d as s,g as l,u as i,w as r,v as c,p as d,t as n,e as o,F as u,M as b,o as p,N as m,c as v,i as y,h,G as f}from"./index-CICC1y_b.js";import{h as g}from"./helperDomain-B2JCiBPY.js";const k={key:0,class:"modal modal-open"},w={class:"w-11/12 sm:w-2/3 max-h-[95vh] bg-white rounded-lg shadow-lg flex flex-col border-2 border-gray-300"},x={class:"flex-grow p-4 overflow-y-scroll"},T={class:"mt-4"},C=["value"],_={class:"mt-4"},j={class:"mt-4"},N={class:"mt-4"},V={__name:"editCard",props:{isVisible:{type:Boolean,required:!0},data:{type:Object,required:!0}},emits:["update:visible","save"],setup(e,{emit:n}){const o=e,u=a({...o.data}),b=n,p=()=>{b("update:visible",!1)};function m(){o.data.cardName?(b("update:visible",!1),b("save",u.value)):alert("請填寫所有欄位")}return(a,n)=>{return e.isVisible?(t(),s("div",k,[l("div",w,[l("div",{class:"modal-header flex justify-between bg-primary rounded-t-lg p-3"},[n[3]||(n[3]=l("h3",{class:"text-xl font-bold text-white"},"票卡管理",-1)),l("button",{onClick:p,class:"btn btn-sm btn-ghost text-white"},"X")]),l("div",x,[l("div",T,[n[4]||(n[4]=l("label",{for:"cardType",class:"block"},"卡片類別:",-1)),l("input",{value:(o=i(u).type,g.cardType2Chinese(o)),id:"cardType",type:"text",class:"input input-bordered w-full",disabled:""},null,8,C)]),l("div",_,[n[5]||(n[5]=l("label",{for:"cardName",class:"block"},"卡片名稱:",-1)),r(l("input",{"onUpdate:modelValue":n[0]||(n[0]=e=>i(u).name=e),id:"cardName",type:"text",class:"input input-bordered w-full"},null,512),[[c,i(u).name]])]),l("div",j,[n[6]||(n[6]=l("label",{for:"returnHomeDate",class:"block"},"歸戶日期:",-1)),r(l("input",{"onUpdate:modelValue":n[1]||(n[1]=e=>i(u).createTime=e),id:"returnHomeDate",type:"text",class:"input input-bordered w-full",disabled:""},null,512),[[c,i(u).createTime]])]),l("div",N,[n[7]||(n[7]=l("label",{for:"cardNumber",class:"block"},"卡片外碼:",-1)),r(l("input",{"onUpdate:modelValue":n[2]||(n[2]=e=>i(u).number=e),id:"cardNumber",type:"text",class:"input input-bordered w-full",disabled:""},null,512),[[c,i(u).number]])]),n[8]||(n[8]=l("div",{class:"divider"},null,-1))]),l("div",{class:"modal-footer mt-auto flex justify-end gap-2 p-2"},[l("button",{onClick:p,class:"btn btn-gray"},"返回"),l("button",{onClick:m,class:"btn-primary"},"儲存")])])])):d("",!0);var o}}},A={class:"card shadow-xl"},D=["src","alt"],M={class:"card-body p-3"},U={class:"card-title"},z={class:"card-footer"},q={class:"flex gap-2 py-2"},H={class:"label cursor-pointer justify-start gap-2"},O={__name:"card",props:{data:{type:Object,default:()=>({cardType:"悠遊卡",cardName:"???",cardNumber:"",isActive:!1,createTime:""}),required:!0}},emits:["save"],setup(e,{emit:r}){const c=e,d=a(!1),b=()=>{d.value=!0},p=r;function m(e){const a={...e};p("save",a)}let v=e=>{let a="/MyInterface/";switch(e){case 1:a+="image/cardtype/easycard.png";break;case 2:a+="image/cardtype/ipass.png";break;case 3:a+="image/cardtype/icash.png";break;default:return""}return a},y=e=>{switch(e){case 1:return"easycard";case 2:return"ipass";case 3:return"icash";default:return""}};return(e,a)=>(t(),s(u,null,[l("div",A,[l("img",{src:i(v)(c.data.type),alt:i(y)(c.data.type),class:"min-h-32 border-gray-300 border-2 rounded-lg"},null,8,D),l("div",M,[l("h2",U,n(c.data.name),1),l("div",z,[l("div",q,[l("button",{class:"btn-primary",onClick:b},"管理"),l("button",{class:"btn-primary",onClick:a[0]||(a[0]=()=>{})},"乘車紀錄查詢")]),l("label",H,[a[4]||(a[4]=l("span",{class:"label-text text-lg"},"參與回饋：",-1)),l("label",{for:"isActive",class:"relative inline-block h-6 w-12 cursor-pointer rounded-full bg-gray-300 transition [-webkit-tap-highlight-color:_transparent] has-[:checked]:bg-green-500",onClick:a[1]||(a[1]=e=>function(e){c.data.isActive=!e;const a={...c.data};p("save",a)}(c.data.isActive))},a[3]||(a[3]=[l("input",{type:"checkbox",id:"isActive",class:"peer sr-only [&:checked_+_span_i[data-checked-icon]]:block [&:checked_+_span_i[data-unchecked-icon]]:hidden"},null,-1),l("span",{class:"absolute inset-y-0 start-0 z-10 m-1 inline-flex size-4 items-center justify-center rounded-full bg-white text-gray-400 transition-all peer-checked:start-6 peer-checked:text-green-600"},[l("i",{"data-unchecked-icon":"",class:"mdi i-mdi-times size-4"}),l("i",{"data-checked-icon":"",class:"mdi i-mdi-check hidden size-4"})],-1)]))])])])]),o(V,{isVisible:i(d),"onUpdate:visible":a[2]||(a[2]=e=>d.value=e),data:c.data,onSave:m},null,8,["isVisible","data"])],64))}},S={role:"tablist",class:"tabs tabs-border"},B={__name:"tabCardType",props:{activeTab:{type:Number,default:1}},emits:["update:activeTab"],setup(e,{emit:a}){const i=e,r=a;function c(e){r("update:activeTab",e)}return(e,a)=>(t(),s("ul",S,[l("li",{role:"tab",class:b([" tab-1 ",{"tab-active":1===i.activeTab}]),onClick:a[0]||(a[0]=e=>c(1))}," 悠遊卡 ",2),l("li",{role:"tab",class:b([" tab-1",{"tab-active":2===i.activeTab}]),onClick:a[1]||(a[1]=e=>c(2))}," 一卡通 ",2),l("li",{role:"tab",class:b([" tab-1",{"tab-active":3===i.activeTab}]),onClick:a[2]||(a[2]=e=>c(3))}," iCash ",2)]))}},E={class:"w-full space-y-4"},F={class:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4"},G={__name:"myCard",setup(r){const c=a(1),d=a([]);p((async()=>{try{const e=await m.getMyCard();d.value=e.data||[]}catch(e){console.error("Error fetching ticket return home list:",e)}}));const n=async e=>{var a=await m.updateMyCard(e);const t=await m.getMyCardList();a.data?(alert("編輯成功。"),d.value=t.data):alert("編輯失敗。")},b=v((()=>d.value?d.value.filter((e=>e.type===c.value)).sort(((e,a)=>new Date(e.createTime)-new Date(a.createTime))):[]));return(a,r)=>{const d=e;return t(),s(u,null,[o(d,{breadcrumbs:["我的票卡"]}),r[2]||(r[2]=l("h1",{class:"title-1"},"我的票卡",-1)),l("div",E,[r[1]||(r[1]=l("div",null,[l("p",null,"活動說明:"),l("p",null,"1. 可選擇歸戶悠遊卡、一卡通、iCash票卡參與常客優惠活動。"),l("p",null,"2. 本活動限普通卡參加，愛心卡、學生卡...不屬於本次優惠範圍。"),l("p",null,"3. 參與本活動的票卡須完成記名，才能累積優惠，票卡記名需至各票卡網站辦理。")],-1)),o(B,{activeTab:i(c),"onUpdate:activeTab":r[0]||(r[0]=e=>y(c)?c.value=e:null)},null,8,["activeTab"]),l("div",F,[(t(!0),s(u,null,h(i(b),((e,a)=>(t(),f(O,{key:a,data:e,onSave:n},null,8,["data"])))),128))])])],64)}}};export{G as default};
